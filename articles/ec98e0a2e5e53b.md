---
title: "Dockerãƒ“ã‚®ãƒŠãƒ¼ã«ã‚ˆã‚‹Dockerç’°å¢ƒæ§‹ç¯‰ for Windows"
emoji: "ğŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["docker", "windows", "wsl"]
published: false
---

# Dockerç’°å¢ƒæ§‹ç¯‰

## Windowsã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Windowsã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’[Microsoft Store](https://aka.ms/terminal)ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

![install-windows-terminal.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-windows-terminal.png)

## Gitã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Gitã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’[https://git-scm.com/download/win](https://git-scm.com/download/win)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—å®Ÿè¡Œã™ã‚‹ã€‚  
å®Ÿè¡Œã—ãŸã‚‰ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å†…å®¹ã«åŒæ„ã—æ¬¡ã¸é€²ã‚€ã€‚

![install-git-1.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-git-1.png)

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é¸æŠã§ã€ä½•ã‚‚å¤‰æ›´ã›ãšæ¬¡ã¸é€²ã‚€ã€‚

![install-git-2.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-git-2.png)

æ–°ã—ã„ãƒªãƒã‚¸ãƒˆãƒªã®æœ€åˆã®ãƒ–ãƒ©ãƒ³ãƒåã‚’è¨­å®šã™ã‚‹ã€‚  
GitHubã®ä»•æ§˜ã«åˆã‚ã›ã¦mainã«å¤‰æ›´ã—æ¬¡ã¸é€²ã‚€ã€‚

![install-git-3.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-git-3.png)

Gitã«æ¥ç¶šã™ã‚‹éš›ã«èªè¨¼è£œåŠ©ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã™ã‚‹ã€‚  
[Git Credential Manager Core]ã‚’é¸æŠã—æ¬¡ã¸é€²ã‚€ã€‚  
â€»[Git Credential Manager Core]ã¯ã€GitHubç­‰ã¨æ¥ç¶šã—ãŸæ™‚ã®2å›ç›®ä»¥é™ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã®å…¥åŠ›ã‚’çœç•¥ã™ã‚‹ã€‚

![install-git-4.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-git-4.png)

è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è¨­å®šã€‚  
ä½•ã‚‚é¸æŠã›ãšã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¸é€²ã‚€ã€‚

![install-git-5.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-git-5.png)

GitBashã‚’é–‹ãã€Gitã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã€‚

```sh
$ git --version;
git version 2.32.0.windows.1
```

ä»¥ä¸Šã§ã€Gitã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯å®Œäº†ã€‚

## WSL2æœ‰åŠ¹åŒ–

PowerShellã‚’é–‹ãã€ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ç®¡ç†è€…ã¨ã—ã¦PowerShellã‚’é–‹ãã€‚

```sh
$ Start-Process powershell.exe -Verb runas;
```

Linuxç”¨Windowsã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚

```sh
$ dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart;
```

ä»®æƒ³ãƒã‚·ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚

```sh
$ dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart;
```

ãƒã‚·ãƒ³ã‚’å†èµ·å‹•ã—ã€Linuxã‚«ãƒ¼ãƒãƒ«æ›´æ–°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’[ã“ã“](https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—å®Ÿè¡Œã™ã‚‹ã€‚

![enable-wsl2-1.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/enable-wsl2-1.png)

ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ã§ã€PowerShellã‚’é–‹ãæ–°ã—ã„Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸéš›ã®æ—¢å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«WSL2ã‚’è¨­å®šã™ã‚‹ã€‚

```sh
$ wsl --set-default-version 2;
```

Microsoft Storeã‚’é–‹ãã€[ã“ã“](https://www.microsoft.com/store/apps/9n6svws3rx71)ã‹ã‚‰ã€Ubuntu 20.04 LTSãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

![enable-wsl2-2.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/enable-wsl2-2.png)

æ–°ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸLinuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆã‚ã¦èµ·å‹•ã™ã‚‹ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã®ã§ã€æ–°ã—ã„Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½œæˆã€‚  

```sh
Installing, this may take a few minutes...
Please create a default UNIX user account. The username does not need to match your Windows username.
For more information visit: https://aka.ms/wslusers
Enter new UNIX username: takuya-motoshima
New password:
Retype new password:
passwd: password updated successfully
Installation successful!
```

ä»¥ä¸Šã§ã€WindowsOSã¨å®Œå…¨ã«çµ±åˆã•ã‚ŒãŸLinuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨è¨­å®šã¯å®Œäº†ã€‚

## Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[https://www.docker.com/](https://www.docker.com/)ã‚’é–‹ãã€[Get started]ã‚’é¸æŠã—ã€DockerDesktopã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€‚

![install-docker-1.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-1.png)

\[Docker Desktop\]ã®\[Download for Windows\]ã‚’é¸æŠã—ã€DockerDesktopã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

![install-docker-2.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-2.png)

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸDocker Desktop Installer.exeã‚’å®Ÿè¡Œã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é€²ã‚ã‚‹ã€‚  
OSã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒWSL2ã«å¯¾å¿œã—ã¦ã„ã‚‹å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçŠ¶æ…‹ã§WSL2ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚  
\[Install required Windows components for WSL 2\]ãŒã€ãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€æ¬¡ã¸é€²ã‚€ã€‚

![install-docker-3.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-3.png)

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰DockerDesktopã‚’èµ·å‹•ã™ã‚‹ã€‚

![install-docker-4.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-4.png)

DockerãŒèµ·å‹•ã—ãŸã‚‰ã€\[Skip tutorial\]ã‚’é¸æŠã—ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã€æ¬¡ã¸é€²ã‚€ã€‚

![install-docker-5.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-5.png)

\[Settings â€“ Resources â€“ WSL INTEGRATION\]ã‚’é–‹ã\[Utuntu-20.04\]ã«ãƒã‚§ãƒƒã‚¯ã‚’ã—ã€  
Utuntu-20.04ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®WSLãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦è¨­å®šã—ã€  
WSL2ã«æ§‹ç¯‰ã—ãŸUtuntu-20.04ä¸Šã§Dockerã‚³ãƒãƒ³ãƒ‰ã®ä½¿ç”¨ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

![install-docker-6.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/install-docker-6.png)

ä»¥ä¸Šã§ã€Dockerã®ç’°å¢ƒæ§‹ç¯‰ã¯å®Œäº†ã€‚

# å…¬å¼ã®hello-worldã§åŸºæœ¬çš„ãªä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹

WindowsTerminalã‚’é–‹ãã€WSL2ã«æ§‹ç¯‰ã—ãŸUtuntu-20.04ã«æ¥ç¶šã™ã‚‹ã€‚

![install-docker-6.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/hellorworld-1.png)

ã¾ãšã¯docker runã‚³ãƒãƒ³ãƒ‰ã§ã€å…¬å¼ã®hello-worldã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã€ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œã‚’ã—ã¦ã¿ã‚‹ã€‚  
ã‚³ãƒ³ãƒ†ãƒŠã¨ã¯ã‚¢ãƒ—ãƒªã‚„ã‚¤ãƒ³ãƒ•ãƒ©ãªã©ã‚’å…¥ã‚ŒãŸç®±ã§ã‚ã‚Šã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã¯ã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã§ã‚ã‚‹ã€‚

```sh
$ docker container run hello-world;
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b8dfde127a29: Pull complete
Digest: sha256:9f6ad537c5132bcce57f7a0a20e317228d382c3cd61edae14650eec68b2b345c
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
```

hello-worldã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ããŸã€‚  
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã«èµ·ã“ã£ãŸã“ã¨ã®èª¬æ˜ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚

```sh
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b8dfde127a29: Pull complete
Digest: sha256:9f6ad537c5132bcce57f7a0a20e317228d382c3cd61edae14650eec68b2b345c
Status: Downloaded newer image for hello-world:latest
```

ä¸Šè¨˜ã¯ã€åˆã‚ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹å ´åˆè¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚ã‚‹ã€‚
ç°¡å˜ã«è§£èª¬ã™ã‚‹ã¨ã€  

- ãƒ­ãƒ¼ã‚«ãƒ«ã«hello-world:latestãŒå­˜åœ¨ã—ãªã„ãŸã‚Docker Hubã‚ˆã‚Šã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–å¾—
- ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’sha256ã§ãƒãƒƒã‚·ãƒ¥åŒ–
- hello-wolrd:latestãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã“ã¨ã‚’è¡¨ã—ã¦ã„ã‚‹

å¾Œã‚ã«å­˜åœ¨ã™ã‚‹latestã¯ã‚¿ã‚°ã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¿ã‚°æŒ‡å®šãªã—ã§å®Ÿè¡Œã—ãŸå ´åˆã€ã‚¿ã‚°ã¯è‡ªå‹•çš„ã«latestãŒé¸æŠã•ã‚Œã‚‹ã€‚  

ç¾åœ¨ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã€‚  

```sh
$ docker image ls;
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    d1165f221234   4 months ago   13.3kB
```

latestã‚¿ã‚°ã‚’æŒã£ãŸhello-worldã‚¤ãƒ¡ãƒ¼ã‚¸ãŒç¢ºèªã§ããŸã€‚  
èµ·å‹•ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

```sh
$ docker container ls;
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
```

ä½•ã‚‚å­˜åœ¨ã—ãªã„ã€‚  
hello-worldã‚³ãƒ³ãƒ†ãƒŠã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡ºåŠ›ãŒçµ‚ã‚ã‚‹ã¨ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ã¦ã—ã¾ã†ãŸã‚ã€èµ·å‹•ã—ã¦ã„ãªã„ã€‚
-a ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã€åœæ­¢ä¸­ã®ã‚³ãƒ³ãƒ†ãƒŠã‚‚è¡¨ç¤ºã—ã¦è¦‹ã‚‹ã€‚

```sh
$ docker container ls -a;
CONTAINER ID   IMAGE         COMMAND    CREATED         STATUS                     PORTS     NAMES
ce078f901c88   hello-world   "/hello"   8 minutes ago   Exited (0) 8 minutes ago             quirky_haibt
```

ã“ã‚Œã§hello-worldã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã‚³ãƒ³ãƒ†ãƒŠã‚’ç¢ºèªã§ããŸã€‚  
æœ€å¾Œã«ã“ã‚Œã‚‰ã‚’å‰Šé™¤ã—ã¦ã€å…¬å¼ã®hello-worldã‚³ãƒ³ãƒ†ãƒŠã®ç¢ºèªã‚’çµ‚ãˆã‚‹ã€‚

```sh
# ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã€‚docker container ls -aã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã—ãŸã‚³ãƒ³ãƒ†ãƒŠIDã‚’æŒ‡å®šã€‚
$ docker container rm ce078f901c88;
ce078f901c88

# ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å‰Šé™¤ã€‚docker image lsã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸IDã‚’æŒ‡å®šã€‚
$ docker image rm d1165f221234;
Untagged: hello-world:latest
Untagged: hello-world@sha256:df5f5184104426b65967e016ff2ac0bfcd44ad7899ca3bbcf8e44e4461491a9e
Deleted: sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726
Deleted: sha256:f22b99068db93900abe17f7f5e09ec775c2826ecfe9db961fea68293744144bd
```

docker container rm <ã‚³ãƒ³ãƒ†ãƒŠID>ã§ã‚³ãƒ³ãƒ†ãƒŠã®å‰Šé™¤ã€  
docker image rm <ã‚¤ãƒ¡ãƒ¼ã‚¸ID>ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å‰Šé™¤ã‚’è¡Œã£ãŸã€‚  
ä»¥ä¸Šã§ã€å…¬å¼ã®hello-worldã‚³ãƒ³ãƒ†ãƒŠã®ç¢ºèªã¯å®Œäº†ã€‚

# Hello Worldã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ

Hello Worldã‚’è¡¨ç¤ºã™ã‚‹WEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œã¾ã§ã‚’è¡Œã„Dockerã®ä½¿ã„æ–¹ã‚’å­¦ã¶ã€‚  
ä»Šå›ã¯WEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨€èªã¯Node.jsã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«Expressã‚’ä½¿ç”¨ã™ã‚‹ã€‚  
ä»¥ä¸‹ã®æµã‚Œã§ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆãƒ»å®Ÿè¡Œã—ã¦ã„ãã€‚

![hellorworld-2.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/hellorworld-2.png)

## æœ€æ–°ã®Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Node.jsã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ä¸Šã§æœ€æ–°ã®Node.jsã‚’ä½¿ç”¨ã—ãŸã„ã€‚  
Dockerãƒ›ã‚¹ãƒˆã«nã¨ã„ã†Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€nãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æœ€æ–°ã®Node.jsã¨npmã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚  
ã¾ãšãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ›´æ–°ã™ã‚‹ã€‚

```sh
$ sudo apt update;
$ sudo apt upgrade
```

Node.jsã¨npmã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
$ sudo apt install nodejs npm;
```

nãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
$ sudo npm -g install n;
```

æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Node.jsã¨npmã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
$ sudo n latest;
```

æ—¢å­˜ã®Node.jsã¨npmã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
$ sudo apt purge nodejs npm;
```

Node.jsã¨npmã®æ›´æ–°ã‚’åæ˜ ã•ã›ã‚‹ç‚ºã«å†ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚

```sh
$ exec $SHELL -l;
```

Node.jsã¨npmã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹ã€‚

```sh
$ node -v;
v16.4.1

$ npm -v;
7.18.1
```

ä»¥ä¸Šã§ã€æœ€æ–°ã®Node.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã€‚

## Node.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹

ã§ã¯é€²ã‚ã¦ã„ãã€‚  
Dockerãƒ›ã‚¹ãƒˆã«ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã€‚

```sh
$ mkdir ~/my-docker;
$ cd  ~/my-docker/;
```

Dockerãƒ›ã‚¹ãƒˆã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã€ package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
$ npm init -y && npm i express;
```

Expressãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ã¦Hello Worldã‚’è¡¨ç¤ºã™ã‚‹WEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’server.jsã«ä½œæˆã™ã‚‹ã€‚

```js:server.js
const express = require('express');

// Constants
const PORT = 8080;
const HOST = '0.0.0.0';

// App
const app = express();
app.get('/', (req, res) => {
  res.send('Hello World');
});

app.listen(PORT, HOST);
```

## Dockerfileä½œæˆ

Dockerfileã¨ã¯ã€Dockerä¸Šã§å‹•ä½œã•ã›ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã®æ§‹æˆæƒ…å ±ã‚’è¨˜è¿°ã™ã‚‹ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€‚  
ã‚¤ãƒ¡ãƒ¼ã‚¸ã®é››å½¢ã§ã‚ã‚Šã€ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç­‰ã®è¿½åŠ å‡¦ç†ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®å®šç¾©ç­‰ã‚’è¨˜è¿°ã—Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®åŸºã¨ãªã‚‹ã€‚

![hellorworld-3.png](https://raw.githubusercontent.com/takuya-motoshima/zenn-content/main/articles/ec98e0a2e5e53b/hellorworld-3.png)

ä»¥ä¸‹ã®Dockerfileã‚’ä½œæˆã™ã‚‹ã€‚

```dockerfile:Dockerfile
FROM node:16

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã™ã‚‹
WORKDIR /var/www

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
COPY package*.json ./
RUN npm install

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹
COPY . .

# å¤–éƒ¨ã«å…¬é–‹ã™ã‚‹ãƒãƒ¼ãƒˆã‚’æŒ‡å®š
EXPOSE 8080
CMD ["node", "server.js"]
```

Dockerfileã«å®šç¾©ã—ãŸå‘½ä»¤ã‚’è©³ã—ãè§£èª¬ã—ã¦ã„ãã€‚

- FROM node:16

    ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒ‡å®šã™ã‚‹ã€‚  
    ä»Šå›ã¯ã€DockerHubã‹ã‚‰å…¥æ‰‹ã§ãã‚‹Node.js 16ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã€‚  
    â€»ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã¯Node.jsã¨npmãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ç‚ºã€æ”¹ã‚ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚

- WORKDIR /var/www

    ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ç½®ãã‚¤ãƒ¡ãƒ¼ã‚¸ä¸Šã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã€‚  
    ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€è‡ªå‹•ã§ç”Ÿæˆã•ã‚Œã‚‹ã€‚

- COPY package*.json ./
- RUN npm install

    Dockerãƒ›ã‚¹ãƒˆã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹package.jsonã¨package-lock.jsonã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã—ã€npm installã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚  
    ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®ãƒãƒ³ãƒ‰ãƒ«ã‚’åˆ†ã‘ã¦ã„ã‚‹ç†ç”±ã¯ã€Dockerãƒ“ãƒ«ãƒ‰ã‚’ã™ã‚‹éš›ã€Dockerfileã§å®Ÿè¡Œæ¸ˆã¿ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½¿ç”¨ã•ã‚Œã‚‹ã€‚  
    ãŸã ã—ã€ADDã‚„COPYã‚³ãƒãƒ³ãƒ‰ã§ãƒ“ãƒ«ãƒ‰åª’ä½“ãªã©ã‚’ã‚³ãƒ³ãƒ†ãƒŠã«ã‚³ãƒ”ãƒ¼ã™ã‚‹éš›ã€ã‚³ãƒ”ãƒ¼å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›´ãŒã‚ã£ãŸå ´åˆã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä½¿ç”¨ã•ã‚Œãšã€æ–°ã—ã„åª’ä½“ãŒã‚³ãƒ³ãƒ†ãƒŠå†…ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã€ãã‚Œä»¥é™ã®å‘½ä»¤ã§ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä½¿ç”¨ã•ã‚Œãªããªã‚‹ã€‚  
    ãã®ãŸã‚ã€å¤‰æ›´ãŒå°‘ãªã„ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’Dockerfileã®æœ€åˆã®æ–¹ã§è¡Œã†ã“ã¨ã§ã€ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¤‰æ›´ãŒãªã„é™ã‚Šã¯2å›ç›®ä»¥é™ã®ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½¿ç”¨ã•ã‚ŒDockerãƒ“ãƒ«ãƒ‰ã®æ™‚é–“ãŒçŸ­ç¸®ã§ãã‚‹ã€‚  

- COPY . .

    Dockerãƒ›ã‚¹ãƒˆã«ã‚ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã€‚

- EXPOSE 8080

    WEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒLISTENã™ã‚‹ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã™ã‚‹ã€‚  
    EXPOSEå‘½ä»¤ã¯å®Ÿéš›ã«ã¯ãƒãƒ¼ãƒˆã‚’å…¬é–‹ã™ã‚‹è¨³ã§ã¯ãªãã€ã©ã®ãƒãƒ¼ãƒˆãŒå…¬é–‹ã•ã‚Œã‚‹ã‹ã¨ã„ã†æƒ…å ±ã‚’æ˜ç¤ºã™ã‚‹ã ã‘ã§ã‚ã‚‹ç‚¹ã«æ³¨æ„ã™ã‚‹ã€‚  
    å®Ÿè¡Œã—ãŸã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’å®Ÿéš›ã«å…¬é–‹ã™ã‚‹ã«ã¯ã€docker container runã§-pã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦Dockerãƒ›ã‚¹ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚

- CMD \["node", "server.js"\]

    WEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®šç¾©ã™ã‚‹ã€‚

## .dockerignoreãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

Dockerãƒ›ã‚¹ãƒˆã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ã‚‹éš›ã«ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã«é€ã‚ŠãŸããªã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’.dockerignoreã«å®šç¾©ã§ãã‚‹ã€‚  

ä»Šå›ã¯èª¤ã£ã¦Dockerãƒ›ã‚¹ãƒˆã«ã‚ã‚‹ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ¡ãƒ¼ã‚¸å†…ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ä¸Šæ›¸ãã•ã‚Œã¦ã—ã¾ã†äº‹æ…‹ã‚’é˜²ãã„ãŸã‚ã€node_modulesã‚’è¨­å®šã™ã‚‹ã€‚

```text:.dockerignore
node_modules
```

## ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ§‹ç¯‰

DockerfileãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚  

- -t ã‚¤ãƒ¡ãƒ¼ã‚¸å[:ã‚¿ã‚°]: åå‰ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚°ã‚’æŒ‡å®šã™ã‚‹ã€‚  
    åå‰ã‚’ä»˜ã‘ãŸæ–¹ãŒåå‰ã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ“ä½œã‚’è¡Œãˆä½œæ¥­åŠ¹ç‡ãŒè‰¯ã„ã®ã¨ã€ã¾ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç®¡ç†ã—ã‚„ã™ã„ã®ã§åå‰ã‚’ä»˜ã‘ã¦ãŠãã€‚

```sh
docker image build -t my-docker .;
```
